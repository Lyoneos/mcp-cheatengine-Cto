# MCP CheatEngine工具集 API参考文档

本文档详细介绍MCP CheatEngine工具集的API接口，包括工具函数、参数说明和返回值格式。

## MCP接口基础

本工具集基于MCP（Model Control Protocol）接口实现，用于与CheatEngine通信。所有工具都通过MCP协议进行注册和调用。

## 工具接口

### 1. ce_connect

连接到CheatEngine并检查连接状态。

**参数**：无

**返回值**：
- 字符串，描述连接状态
- 示例：`"已成功连接到CheatEngine服务器 127.0.0.1:8082，连接正常"`

### 2. memory_read

读取指定内存地址的数据。

**参数**：
- `address` (必须)：内存地址，支持以下格式：
  - 十六进制字符串，如 `"0x7065F60"`
  - 整数，如 `117879888`
- `data_type` (必须)：数据类型，字符串，支持以下类型：
  - `"byte"`：8位整数
  - `"int16"`：16位整数
  - `"int32"`：32位整数
  - `"int64"`：64位整数
  - `"float"`：单精度浮点数
  - `"double"`：双精度浮点数
  - `"string"`：字符串
  - `"bytes"`：原始字节数组
- `options` (可选)：配置选项，字典，支持以下选项：
  - `assembly`：是否返回汇编代码，布尔值
  - `assemblySize`：要反汇编的指令数量，整数
  - `rawBytes`：是否返回原始字节，布尔值
  - `bytesSize`：读取的原始字节数量，整数
  - `opcode`：是否返回操作码，布尔值
  - `opcodeSize`：操作码字节数，整数
  - `comments`：是否返回地址注释，布尔值
  - `multiType`：是否返回多种数据类型解释，布尔值
  - `instructionMultiType`：是否为指令提供多种解释，布尔值

**返回值**：
- 字典，包含以下键值：
  - `success`：操作是否成功，布尔值
  - `address`：格式化后的内存地址，字符串
  - `dataType`：请求的数据类型，字符串
  - `value`：读取的值，根据数据类型可能为整数、浮点数、字符串等
  - `error`：如果操作失败，包含错误信息，字符串
  - `bytes`：如果请求了原始字节，包含十六进制字节数组，字符串数组
  - `assembly`：如果请求了汇编代码，包含汇编指令对象数组，每个对象包含地址和指令
  - `opcode`：如果请求了操作码，包含十六进制操作码数组，字符串数组
  - `comments`：如果存在注释且请求了注释，包含注释内容，字符串
  - `multiType`：如果请求了多种类型解释，包含不同数据类型的解释，字典

### 3. test_echo

接收任意类型的输入并原样输出，用于测试和调试。

**参数**：
- `input_data`：任意类型的输入数据(字符串、数字、列表、字典等)

**返回值**：
- 字典，包含以下键值：
  - `success`：操作是否成功，布尔值
  - `input`：输入数据，可能经过JSON解析
  - `original_input`：原始输入数据，未经处理
  - `type`：输入数据的类型名称，字符串
  - `meta`：元数据字典，包含以下信息：
    - `timestamp`：处理时间戳
    - `is_primitive`：是否为原始类型，布尔值
    - `length`：如果数据有长度，则包含长度信息
    - 根据不同数据类型，还可能包含其他元信息

## 通信协议

### 数据包格式

CheatEngine与工具集之间的通信采用以下数据包格式：

```
+--------+--------+-------------+
| 类型 2B | 长度 2B | 数据 (变长) |
+--------+--------+-------------+
```

- 类型：2字节，表示数据包类型
- 长度：2字节，表示数据部分的长度
- 数据：变长，具体格式取决于数据包类型

### 数据包类型

- `0x01` ASSEMBLY：汇编代码
- `0x02` BYTECODE：原始字节码
- `0x03` TEXT：文本消息
- `0x04` COMMAND：命令
- `0x05` RESPONSE：响应
- `0x10` MEMORY_READ：内存读取
- `0x11` MEMORY_WRITE：内存写入
- `0x12` MEMORY_BATCH：批量内存读取
- `0x13` ASSEMBLY_WRITE：汇编代码修改
- `0x20` LUA_EXEC：Lua代码执行
- `0x30` ENUM_MODULES：枚举进程模块
- `0x31` POINTER_SCAN：指针扫描
- `0x32` POINTER_READ：模块偏移指针读取
- `0xFF` ERROR：错误

## 错误处理

API调用可能会返回各种错误信息，常见错误包括：

- 连接错误：无法连接到CheatEngine
- 通信错误：通信过程中发生错误
- 格式错误：参数格式不正确
- 值错误：参数值不合法
- 超时错误：操作超时

错误信息会在返回值的`error`字段中提供。